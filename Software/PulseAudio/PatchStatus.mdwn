# Patch status

This page tracks the status of submitted patches that haven't been merged yet. The contents are updated at least once every two weeks, so very recently submitted patches may be missing. If something older is missing, please contact the maintainers (via the [mailing list](https://lists.freedesktop.org/mailman/listinfo/pulseaudio-discuss) or IRC). This list is new and still not finished, so it's known that the oldest GitLab merge requests and everything in Patchwork is still missing.

The patches have been ordered by priority, with the highest priority patches at the top. If your patch is low in the list, there's a real risk that it won't be reviewed at all, because patches are currently submitted at a higher rate than they are reviewed. This is a sad situation, and if you don't like it, please volunteer to become a reviewer!

* Better module-jackdbus-detect options
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/merge_requests/37]]
  * Adds separate channel arguments for sinks and sources in module-jackdbus-detect. Arun has already reviewed this, but didn't merge due to 13.0 freeze. Merging this during the 14.0 development cycle was forgotten, and now we're in 14.0 freeze, so this will have to wait for a bit more still.

* mainwindow: quit application instead of main
  * [[https://gitlab.freedesktop.org/pulseaudio/pavucontrol/merge_requests/29]]
  * Fixes a crash when exiting pavucontrol with ctrl-q. Looks pretty simple.

* Improvements to reconfiguration
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/merge_requests/24]]
  * Using the Dolby TrueHD and DTS-HD Master Audio formats requires using 8 channels, and these patches implement the necessary reconfiguration logic. This was supposed to work already in 13.0 (the release notes promised that), so these patches should probably have a very high priority.

* Messaging API v2
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/merge_requests/51]]
  * Implements new infrastructure that is expected to be used for many features in the future. Tanu has already reviewed some of the patches. Big change.

* pavuapplication: allow one window per server
  * [[https://gitlab.freedesktop.org/pulseaudio/pavucontrol/merge_requests/11]]
  * Fixes a regression when using pavucontrol with multiple servers. The patch probably needs to be completely rewritten, however, because mangling the bus name is an ugly hack.

* qpaeq: fix: resizing on HiDPI (!41)
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/merge_requests/41]]
  * Fixes infinite recalculations when resizing the qpaeq window on a HiDPI system. Pretty small change, but not trivial.

* WIP: #303: unload bt modules
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/merge_requests/10]]
  * Disables bluetooth whenever the user is not active. This is an important fix - currently distributions need to apply workarounds for gdm to ensure that gdm doesn't interfere with the real user's bluetooth use, and probably not all distributions do that, meaning that we can never be sure if the reason behind broken bluetooth is that gdm is interfering with it. Medium sized change.

* raop: Improve volume management
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/merge_requests/129]]
  * Fixes unsynchronized volume updates (hw volume is updated immediately, soft volume takes 2 seconds to take effect). Very small code change.
  * Comment from Tanu: I suspect it's too simple. I think there should be two modes: either hardware volume, which is fast but doesn't allow different volumes for different channels, or soft volume, which is very slow but supports per-channel volumes. Then there's the question whether the hardware volume mode should support decibel volumes or not. Not supporting decibel volumes would have the benefit that UIs would show a continuous volume scale, whereas with decibel volumes the volume couldn't be set below 32% (which is -30dB, the minimum volume allowed by the protocol).

* Introduce meson-based build
  * [[https://gitlab.freedesktop.org/pulseaudio/pavucontrol/merge_requests/17]]
  * New feature. Medium sized change.

* WIP: Support of Airplay2 devices
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/merge_requests/194]]
  * Improves hardware support. 2 commits. Unfinished work. Not a small change, but not huge either.

* Rewind and resampler fixes
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/merge_requests/120]]
  * Fixes crackling during volume changes caused by resampler resets. Big change.
  * Comment from Tanu: I started to review it, and I disagreed with Georg how the new history queue should be managed. I got demotivated due to the complexity of the code and Georg's unwillingness to accept my proposal that would make it easier for me to understand the system (according to Georg, my proposal is even more complex than his).

* Tunnel and combine-sink latency fixes
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/merge_requests/53]]
  * Fixes latency calculations. Adds a latency configuration modarg to module-tunnel. A somewhat large change, but it's split into 6 patches so the individual patches should be pretty manageable.

* WIP: Add a way to set the intended roles for mappings
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/merge_requests/71]]
  * This is supposed to make phone streams go automatically to the chat channel of the Arctis headsets, but the patch author reported that the routing isn't working even though the sink has the intended-roles property correctly set, which is why the patch is marked as WIP. The patch author didn't respond to Arun's question. The patch is pretty simple, and seems like a pretty good change, so it could be worth trying to reproduce the issue (by writing some custom configuration, intended roles could be tested without the Arctis headset).

* bluetooth: HFP profile implementation
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/merge_requests/94]]
  * Improves hardware support. HFP-only headsets can't currently be used without oFono, and using them with oFono is difficult. Apparently this patch was developed independently from James Bottomley's earlier implementation - what are the differences between the two implementations? Medium sized change.
  * The newest version (as of 2019-11-27) of James's patches are at [[https://git.kernel.org/pub/scm/linux/kernel/git/jejb/pulseaudio.git/log/?h=jejb-v13]]
  * There's also this version that has some improvements on top of James's patches: [[https://github.com/paravoid/pulseaudio/commits/hfp-v7]]

* Unload bluez5 devices when bluez5-discover is unloaded
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/merge_requests/42]]
  * Fixes a minor bug: when unloading module-bluez5-discover, the module-bluez5-device modules currently are left loaded. Pretty simple change.

* Added 3 columns (`mute-state`, `volume` and `default sink`) to output of `pactl list short sinks`.
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/merge_requests/159]]
  * New feature. Adds more information to "pactl list sinks short" (corresponding change for sources is missing). Pretty simple change.
  * Comment from Tanu: I'm not sure we want this - to make scripting easier, we could also add separate commands for getting the individual attributes.

* Permit root-owned home directory
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/merge_requests/134]]
  * New feature. Helps users with certain kind of NFS setups. One-liner, but checking that the change actually makes sense may take some effort.

* WIP: Virtual sink consolidation
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/merge_requests/88]]
  * Reduces code duplication in virtual sinks. The resampler rewind patches (!120) should be reviewed first, after which Georg will rebase these patches. Big change.

* WIP: virtual sinks/sources: Fix crash with stacked virtual sinks or sources
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/merge_requests/78]]
  * Crash fix. Arun has reviewed this, but the plan is to wait for the virtual sink consolidation patches (!88) to land first.

* WIP: Don't create card profile for unsupported Bluetooth profiles
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/merge_requests/50]]
  * Apparently fixes an issue of creating card profiles that aren't supported by the local bluetooth adapter. Marked as WIP, because the patches expose some bug in the kernel.
  * Comment from Tanu: I don't know what would be a concrete example of the problem, so it's hard to say how important this fix is.

* Add alternative time smoother implementation
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/merge_requests/55]]
  * Improves at least module-loopback's latency stability. Pretty large change, and probably math-heavy.
  * Comment from Tanu: Based on a quick glance at [[https://www.freedesktop.org/software/pulseaudio/misc/rate_estimator.odt]], the improvement is big in relative terms, but small in absolute terms (less than one millisecond).
  * When asked for more concrete description of what problems the patches solve, Georg said this: "I never systematically compared absolute values of the latencies, I just verified that they are in the same range. What rate_estimator.odt shows is just the stability of the reported value. The stability has a big impact on loopback and combine sink because they amplify those small fluctuations. Otherwise I cannot put a finger on specific problems but still I have the impression that overall I am getting less glitches."
  * Comment from Georg: Since it is providing an alternative implementation and not a replacement I think it would be more or less sufficient to review patches 2 - 10 and "believe" patch 1. (which is what we currently do with the old smoother code or do you understand that?)

* Loopback patches
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/merge_requests/56]]
  * Various improvements to module-loopback. How big improvements? Hard to say from a quick glance. As a whole it's a somewhat big change, but it's split into 10 patches, so individual patches aren't that big (but the math-heavy topic can make reviewing more difficult).
  * The first patch should be included soon as it fixes a bug. Patches 2 - 4 significantly improve the stability of the latency while patch 5 improves the readability of the debug output. Patches 6 - 10 add new parameters and small enhancements that aim to get the last possible bit of precision out of the module. Therefore it should be evaluated if any of patches 6 - 10 should be included at all.  

### Patches that need to be prioritized

* build: support using elogind
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/merge_requests/1]]

* alsa-mixer: add mono input support for Behringer UMC22
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/merge_requests/223]]
