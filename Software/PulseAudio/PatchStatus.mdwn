# Patch status

This page tracks the status of submitted patches that haven't been merged yet. The contents are updated at least once every two weeks, so very recently submitted patches may be missing. If something older is missing, please contact the maintainers (via the [mailing list](https://lists.freedesktop.org/mailman/listinfo/pulseaudio-discuss) or IRC). This list is new and still not finished, Patchwork still has many patches that are not tracked here.

The patches have been ordered by priority, with the highest priority patches at the top. If your patch is low in the list, there's a real risk that it won't be reviewed at all, because patches are currently submitted at a higher rate than they are reviewed. This is a sad situation, and if you don't like it, please volunteer to become a reviewer!


* alsa-ucm: Avoid unnecessary duplication in mapping descriptions
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/-/merge_requests/366]]
  * Improves sink naming with UCM. Very small change, but it would be good to understand why the duplication happens in the first place, so reviewing isn't that trivial (it may be still be easy once someone spends more than a few seconds looking at the code).

* alsa-card: add dynamic priority bonus base for alsa profiles
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/-/merge_requests/355]]
  * Small but possibly a bit tricky profile priority/availability patch.
  * Fixes a significant problem with UCM: UCM doesn't generate profiles for all device permutations, wihch with the current logic leads to important profiles being marked as unavailable if any component device in them is unavailable.

* module-switch-on-port-available: check default sink/source before switch
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/-/merge_requests/370]]
  * Attempts to fix a UCM related bug: when there are multiple sinks or sources on one profile, module-switch-on-port-available does sometimes nonsensical port switches.
  * Tanu reviewed the first version and suggested a different fix. As of 2020-09-28, discussion is ongoing about the correct fix.

* tests: Fix incompatible pointer type on Debian kfreebsd
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/-/merge_requests/356]]

* alsa-ucm: Make sure UCM uses DisableSequence
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/-/merge_requests/357]]

* clear compiling warning
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/-/merge_requests/330]]
  * Simple patches, Tanu reviewed them but they need some polishing.

* utils: Eliminate compilation warnings
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/-/merge_requests/331]]
  * Disables a warning (`-Wno-logical-op`) without a proper explanation. If the submitter doesn't reply soon, this can be closed.

* meson: add doxygen target
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/-/merge_requests/346]]
  * Arun pointed out issues that need to be fixed.
  * Why this patch is important: we're removing Autotools in 15.0, so it would be good to test that the release process using Meson works already in 14.0. Updating the Doxygen documentation is part of the release process.

* WIP: Disable UCM devices on suspend
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/-/merge_requests/307]]
  * Various UCM cleanups, in addition to the main patch that implements a possible power consumption improvement with UCM.
  * There's a bug that needs to be fixed before this can be merged.
  * Arun reviewed the first version, and we agreed to have this in 14.0 once the bug is fixed.

* alsa-mixer: Respect XDG base directory spec when loading profile sets
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/-/merge_requests/311]]
  * Completes the work started in MR 293 (which is reviewed and waiting for the freeze to end).

* ucm: add possibility to skip the UCM card completely (Linked)
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/-/merge_requests/305]]
  * Implements a new UCM feature, required for some hardware.

* Don't assume that version_split have at least 2 elements
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/-/merge_requests/289]]
  * Small patch, but it doesn't really make sense. The version should always have at least 2 elements. The problem that this patch fixes needs to be investigated further.

* alsa-ucm: create profiles per conflicting device group
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/-/merge_requests/290]]
  * Important improvement to the UCM profile generation logic (currently we may generate profiles that have two conflicting devices active at the same time).

* alsa-mixer: add support for Sennheiser GSX 1000 gaming DAC
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/-/merge_requests/257]]
  * Simple change. Tanu reviewed the first version, changes requested. See also the next MR, !286.

* Add udev rules and a profile for Sennheiser GSX devices.
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/-/merge_requests/286]]
  * This is probably pretty much the same as the previous MR, !257.

* Fix up Meson build support for Windows / Add AF_UNIX support for Windows
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/-/merge_requests/360]]
  * Important, because without this we'd lose Windows support when dropping Autotools.

* Update module directory logic
  * [[https://gitlab.freedesktop.org/pulseaudio/paprefs/merge_requests/7]]
  * The plan is to remove the version number from the module directory in PulseAudio 15.0. paprefs needs to adapt to that, preferably before the change happens so that the transition to the new directory goes without glitches. High priority, because Tanu wants to release a new paprefs version ASAP, and this is the only thing blocking the release.

* Improvements to reconfiguration
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/merge_requests/24]]
  * Using the Dolby TrueHD and DTS-HD Master Audio formats requires using 8 channels, and these patches implement the necessary reconfiguration logic. This was supposed to work already in 13.0 (the release notes promised that), so these patches should probably have a very high priority.

* remove autotools
  * [[https://gitlab.freedesktop.org/pulseaudio/webrtc-audio-processing/-/merge_requests/7]]

* Bluetooth A2DP codecs
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/merge_requests/227]]
  * Adds support for more codecs. Big change. Georg has been reviewing some of the patches. The next step is to agree how to implement the codec switching (at least Tanu and Arun don't like Pali's proposal to use the card profile switching mechanism for choosing the codec).

* alsa-ucm: allow binding same mic to multiple profiles
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/-/merge_requests/271]]

* Support jack index
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/-/merge_requests/272]]
  * Adds support for jack controls with index other than zero. Adds some new jacks to the path configurations.
  * Tanu already reviewed the first version (changes requested).

* alsa-mixer: support up to 8 channels per mixer element
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/-/merge_requests/292]]
  * Improves hardware volume handling. Important now that UCM is starting to have configuration for hardware with this kind of mixer elements. With UCM we can't gracefully fall back to software volume, because UCM will set the volume to zero when switching away from the device, so we must support hardware volume properly.

* Rewind and resampler fixes
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/merge_requests/120]]
  * Fixes crackling during volume changes caused by resampler resets. Big change.
  * Comment from Tanu: I started to review it, and I disagreed with Georg how the new history queue should be managed. I got demotivated due to the complexity of the code and Georg's unwillingness to accept my proposal that would make it easier for me to understand the system (according to Georg, my proposal is even more complex than his).

* FreeBSD support: meson build, import downstream patches, more improvements
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/-/merge_requests/277]]
  * 19 small patches. Includes a simple module for handling hotplugged devices on FreeBSD.

* build-sys: Remove version number from installed files
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/merge_requests/230]]
  * Causes less file name changes during updates, which can make life easier for packagers.

* Restore ability to quit with the escape key
  * [[https://gitlab.freedesktop.org/pulseaudio/pavucontrol/-/merge_requests/37]]

* pavuapplication: allow one window per server
  * [[https://gitlab.freedesktop.org/pulseaudio/pavucontrol/merge_requests/11]]
  * Fixes a regression when using pavucontrol with multiple servers. The patch probably needs to be completely rewritten, however, because mangling the bus name is an ugly hack.

* qpaeq: fix: resizing on HiDPI (!41)
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/merge_requests/41]]
  * Fixes infinite recalculations when resizing the qpaeq window on a HiDPI system. Pretty small change, but not trivial.

* WIP: #303: unload bt modules
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/merge_requests/10]]
  * Disables bluetooth whenever the user is not active. This is an important fix - currently distributions need to apply workarounds for gdm to ensure that gdm doesn't interfere with the real user's bluetooth use, and probably not all distributions do that, meaning that we can never be sure if the reason behind broken bluetooth is that gdm is interfering with it. Medium sized change.

* bluetooth: add support of mSBC codec to HFP profile
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/-/merge_requests/254]]
  * Should improve audio quality with HFP. Pali has done some review. Big change.

* bluetooth: Unify A2DP sink/source volumes with AVRCP Absolute Volume.
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/merge_requests/239]]
  * New feature. Very useful. Somewhat large change.

* raop: Improve volume management
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/merge_requests/129]]
  * Fixes unsynchronized volume updates (hw volume is updated immediately, soft volume takes 2 seconds to take effect). Very small code change.
  * Comment from Tanu: I suspect it's too simple. I think there should be two modes: either hardware volume, which is fast but doesn't allow different volumes for different channels, or soft volume, which is very slow but supports per-channel volumes. Then there's the question whether the hardware volume mode should support decibel volumes or not. Not supporting decibel volumes would have the benefit that UIs would show a continuous volume scale, whereas with decibel volumes the volume couldn't be set below 32% (which is -30dB, the minimum volume allowed by the protocol).

* core-util: Set nice value for the task group
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/merge_requests/234]]
  * Apparently the "high-priority" option doesn't currently have any effect on many systems, because the nice value is set relative to other processes in the same task group, and PulseAudio is the only process in its task group. This change is supposed to apply the nice value to the task group instead of the process, which should restore the intended behaviour.

* Introduce meson-based build
  * [[https://gitlab.freedesktop.org/pulseaudio/pavucontrol/merge_requests/17]]
  * New feature. Medium sized change.

* WIP: Support of Airplay2 devices
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/merge_requests/194]]
  * Improves hardware support. 2 commits. Unfinished work. Not a small change, but not huge either.

* Tunnel and combine-sink latency fixes
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/merge_requests/53]]
  * Fixes latency calculations. Adds a latency configuration modarg to module-tunnel. A somewhat large change, but it's split into 6 patches so the individual patches should be pretty manageable.

* bluetooth-legacy: Create bluetooth legacy as copy of current bluetooth codebase
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/-/merge_requests/314]]

* WIP: Bluetooth HSP and HFP profiles implementation via hsphpfd daemon
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/-/merge_requests/288]]
  * See also the next MR, !94.

* bluetooth: HFP profile implementation
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/merge_requests/94]]
  * Improves hardware support. HFP-only headsets can't currently be used without oFono, and using them with oFono is difficult. Apparently this patch was developed independently from James Bottomley's earlier implementation - what are the differences between the two implementations? Medium sized change.
  * The newest version (as of 2019-11-27) of James's patches are at [[https://git.kernel.org/pub/scm/linux/kernel/git/jejb/pulseaudio.git/log/?h=jejb-v13]]
  * There's also this version that has some improvements on top of James's patches: [[https://github.com/paravoid/pulseaudio/commits/hfp-v7]]
  * See also the previous MR, !288.

* Unload bluez5 devices when bluez5-discover is unloaded
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/merge_requests/42]]
  * Fixes a minor bug: when unloading module-bluez5-discover, the module-bluez5-device modules currently are left loaded. Pretty simple change.

* Added 3 columns (`mute-state`, `volume` and `default sink`) to output of `pactl list short sinks`.
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/merge_requests/159]]
  * New feature. Adds more information to "pactl list sinks short" (corresponding change for sources is missing). Pretty simple change.
  * Comment from Tanu: I'm not sure we want this - to make scripting easier, we could also add separate commands for getting the individual attributes.

* WIP: Virtual sink consolidation
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/merge_requests/88]]
  * Reduces code duplication in virtual sinks. The resampler rewind patches (!120) should be reviewed first, after which Georg will rebase these patches. Big change.

* WIP: Don't create card profile for unsupported Bluetooth profiles
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/merge_requests/50]]
  * Apparently fixes an issue of creating card profiles that aren't supported by the local bluetooth adapter. Marked as WIP, because the patches expose some bug in the kernel.
  * Comment from Tanu: I don't know what would be a concrete example of the problem, so it's hard to say how important this fix is.

* Add alternative time smoother implementation
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/merge_requests/55]]
  * Improves at least module-loopback's latency stability. Pretty large change, and probably math-heavy.
  * Comment from Tanu: Based on a quick glance at [[https://www.freedesktop.org/software/pulseaudio/misc/rate_estimator.odt]], the improvement is big in relative terms, but small in absolute terms (less than one millisecond).
  * When asked for more concrete description of what problems the patches solve, Georg said this: "I never systematically compared absolute values of the latencies, I just verified that they are in the same range. What rate_estimator.odt shows is just the stability of the reported value. The stability has a big impact on loopback and combine sink because they amplify those small fluctuations. Otherwise I cannot put a finger on specific problems but still I have the impression that overall I am getting less glitches."
  * Comment from Georg: Since it is providing an alternative implementation and not a replacement I think it would be more or less sufficient to review patches 2 - 10 and "believe" patch 1. (which is what we currently do with the old smoother code or do you understand that?)

* Loopback patches
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/merge_requests/56]]
  * Various improvements to module-loopback. How big improvements? Hard to say from a quick glance. As a whole it's a somewhat big change, but it's split into 10 patches, so individual patches aren't that big (but the math-heavy topic can make reviewing more difficult).
  * The first patch should be included soon as it fixes a bug. Patches 2 - 4 significantly improve the stability of the latency while patch 5 improves the readability of the debug output. Patches 6 - 10 add new parameters and small enhancements that aim to get the last possible bit of precision out of the module. Therefore it should be evaluated if any of patches 6 - 10 should be included at all.  

* FreeBSD support
  * [[https://gitlab.freedesktop.org/pulseaudio/webrtc-audio-processing/merge_requests/6]]

* Use WAVEFORMATEXTENSIBLE for multi-channel audio output on Windows.
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/-/merge_requests/359]]

* Check for pulseaudio daemon by socket instead of by pid
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/-/merge_requests/296]]
  * Simple change, but might not be what we want. The proposed implementation will start the daemon if socket activation or autospawning is enabled.

### Patches that have been reviewed and can be merged after the freeze ends

* alsa-mixer: add mono input support for Behringer UMC22
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/merge_requests/223]]

* module-jackdbus-detect: Add channel_map argument for sink
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/merge_requests/233]]

* core, modules: Remove useless EINTR tests
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/merge_requests/238]]

* module-zeroconf-discovery: Add parameter for switching to new tunnel modules
  * [[https://patchwork.freedesktop.org/patch/304205/]]

* module: Check version before loading a module
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/merge_requests/249]]

* build-sys: Add an option for enabling/disabling Valgrind
  * https://gitlab.freedesktop.org/pulseaudio/pulseaudio/-/merge_requests/250

* added hidden args to set pkgconfig and cmake template path
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/merge_requests/244]]

* tunnel-sink-new: log buffer events
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/-/merge_requests/259]]
  * Simple change that adds some more logging. Only changes the sink, the source should be changed too.
  * Does it make sense to set both underflow and overflow callbacks? Can both events happen with a playback stream?

* pstream: Log "Cannot send block reference..." only once per pstream
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/-/merge_requests/265]]

* sink: Reduce chat sink priority
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/-/merge_requests/266]]

* alsa-mixer: Enable volume control of SteelSeries Arctis stereo output
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/-/merge_requests/274]]

* alsa-sink: increase watermark when there is nothing to rewind
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/-/merge_requests/287]]

* bluetooth: policy: Remove BlueZ 4 related code
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/-/merge_requests/291]]

* alsa-mixer: Respect XDG base directory spec when loading path configs
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/-/merge_requests/293]]

* alsa-mixer: Pick at most one fallback mapping
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/-/merge_requests/304]]

* alsa-mixer: add support for Astro A50
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/-/merge_requests/321]]

* Warning fixes
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/-/merge_requests/333]]

* pulsecore: thread-posix.c: remove unnecessary assignment
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/-/merge_requests/335]]

* Messaging API v2
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/merge_requests/51]]
  * Implements new infrastructure that is expected to be used for many features in the future. Tanu has already reviewed some of the patches. Big change.

* alsa-mixer: Add support for HP Thunderbolt Dock
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/-/merge_requests/353]]
  * Pretty simple configuration addition.

* switch-on-port-available: checking the off profile when switching profile
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/-/merge_requests/354]]

* Add default.pa.d folder support
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/-/merge_requests/361]]

* alsa-mixer: Add support for the Center/LFE element
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/-/merge_requests/362]]

* sink: Increase JACK device priority
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/-/merge_requests/369]]

* main: set LC_NUMERIC to C
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/-/merge_requests/375]]

* mutex-posix: Log pthread_mutex_unlock() error
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/-/merge_requests/376]]

### Patches that need to be prioritized

* echo-cancel: preliminary support for WebRTC AEC3
  * [[https://gitlab.freedesktop.org/pulseaudio/pulseaudio/-/merge_requests/374]]
  * Adds support for a newer WebRTC echo canceller version. It's mutually exclusive with the old version, the decision is done at build time.
  * The new version doesn't depend on libwebrtc-audio-processing, it depends on building upstream WebRTC as a static library.
  * The change is pretty big, but most of it is the new file webrtc-aec3.cc, which is probably largely copy-pasted from the old webrtc.cc file. The rest of the change is pretty straightforward build system stuff, so reviewing this shouldn't be too daunting.
